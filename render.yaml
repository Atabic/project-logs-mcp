# Render Blueprint – deploy this repo as a Web Service
# Dashboard: https://dashboard.render.com → New → Blueprint
# Or use "New Web Service" and leave Root Directory blank.
#
# For ERP browser auth to work, use one of:
#   A) Runtime: Docker (recommended) – Render uses the Dockerfile; Chromium is pre-installed in the image.
#   B) Runtime: Python – build installs Chromium into the project dir via PLAYWRIGHT_BROWSERS_PATH.

services:
  - type: web
    name: project-logs-mcp
    runtime: python
    plan: free

    # Install Chromium into project dir so it's available at runtime (Render's ~/.cache can differ between build and run).
    buildCommand: pip install -r requirements-sse.txt && PLAYWRIGHT_BROWSERS_PATH=./playwright-browsers playwright install chromium
    startCommand: python server_sse.py

    # Python version: set by runtime.txt (python-3.12.0)
    envVars:
      # Required for Playwright to find Chromium when using Python runtime (must match build path).
      - key: PLAYWRIGHT_BROWSERS_PATH
        value: ./playwright-browsers
      # Add in Render Dashboard → Environment (sensitive values):
      # - key: ERP_API_BASE_URL
      #   value: https://your-erp.example.com/api/v1/
      # - key: MCP_SSE_PUBLIC_URL
      #   value: https://project-logs-mcp.onrender.com  # your deployed MCP URL (enables ERP browser auth from deployed URL)
      # - key: MCP_AUTHORIZED_USERS
      #   sync: false  # set in Dashboard: comma-separated emails
